<!doctype html>
<html lang="fr">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">

	<link rel="stylesheet" href="css/reset.css"> <!-- CSS reset -->
	<link rel="stylesheet" href="css/style.css"> <!-- Resource style -->
	<script src="js/modernizr.js"></script> <!-- Modernizr -->

	<!-- FAVICON -->
	<link rel="icon" href="img/logoIMSSA.ico" type="image/x-icon">

	<title>Site IMSSA | Accueil</title>
	<style>
		.hero-text p{
			background: white;
			padding: 15px;
			border-radius: 10px;
			text-align: center;
			box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
		}

		.hero-text h1 {
			margin-top: 50px;
			text-align: center;
			font-size: 2em;
		}
	
		.hero-img {
			width: 100%;
			height: auto;
			border-radius: 20px;
			box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
			display: block; /* Transforme l'image en √©l√©ment de bloc */
			margin: 0 auto; /* Centre horizontalement */
			padding-top: 10px;
		}
	
		.team-grid {
			display: grid;
			grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
			gap: 20px;
		}
	
		.praticien-card {
			background: white;
			padding: 15px;
			border-radius: 10px;
			border: 2px solid white;
			box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
			text-align: center;
		}
	
		.praticien-card:hover {
			border: 2px solid #1AA9BE;
			transform: translateX(2px);
			box-shadow: 0 6px 12px rgba(0, 0, 0, 0.3);
		}
	
		.praticien-card img {
			height: 40%;
		}
		@media only screen and (min-width: 1024px) {
			.hero-img {
				width: 50%;
				grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
			}
			.hero-text h1::after {
				content: " - Kin√© ‚Ä¢ Sport ‚Ä¢ Sant√©";
			}
		}
	</style>
</head>

<body>
	<header>
		<div class="navbar">
			<div>
				<a href="index.html" class="nav__logo">
					<img src="img/logoIMSSA.ico" alt="logo IMSSA" id="logo_header"> IMSSA accueil
				</a>
			</div>
			<div class="cd-dropdown-wrapper">

				<a href="menu.html" id="btn-fav" class="navbar-btn">‚ù§Ô∏è</a>
				<a href="#0" id="btn-google" class="navbar-btn">üîí</a>

				<!--		 DROPDOWN		 -->
				<a class="cd-dropdown-trigger" href="#0">Menu</a>
				<nav class="cd-dropdown">
					<h2>Menu</h2>
					<a href="#0" class="cd-close">Fermer</a>
					<ul class="cd-dropdown-content">

						<li class="cd-divider">Exercices</li>

						<!-- Ici on injecte dynamiquement les cat√©gories JSON -->

						<li id="menu"></li>

						<li class="cd-divider">Autre</li>

						<li class="has-children">
							<a href="#0">Contact</a>
							<ul class="cd-dropdown-icons is-hidden">
								<li class="go-back"><a href="#0">Contact</a></li>
								<li>
									<a class="cd-dropdown-item item-1" target="_blank"
										href="https://www.instagram.com/imssa68?utm_source=ig_web_button_share_sheet">
										<h3>Instagram</h3>
										<p>Retrouvez nous sur Instagram</p>
									</a>
								</li>

								<li>
									<a class="cd-dropdown-item item-2" target="_blank" href="#0">
										<h3>TikTok</h3>
										<p>Retrouvez nous sur TikTok</p>
									</a>
								</li>

								<li>
									<a class="cd-dropdown-item item-3" target="_blank" href="#0">
										<h3>Mail</h3>
										<p>Nous contacter par mail</p>
									</a>
								</li>

								<li>
									<a class="cd-dropdown-item item-4" target="_blank"
										href="https://imssa.monrdvkine.fr">
										<h3>MonRdvKin√©</h3>
										<p>Prendre rendez-vous</p>
									</a>
								</li>

								<li>
									<a class="cd-dropdown-item item-5" target="_blank" href="tel:+33389605426">
										<h3>T√©l√©phone</h3>
										<p>03 89 60 54 26</p>
									</a>
								</li>

								<li>
									<a class="cd-dropdown-item item-6" target="_blank"
										href="https://www.google.fr/maps/place/IMSSA+Institut+M√©dico-Sportif+Sud+Alsace/@47.7314575,7.3131683,16z/data=!3m1!4b1!4m6!3m5!1s0x47919bc25e3f6491:0xdd3ad8e21621fc7b!8m2!3d47.7314539!4d7.3157432!16s%2Fg%2F11fsm1b_fz?entry=ttu&g_ep=EgoyMDI1MDkwOC4wIKXMDSoASAFQAw%3D%3D">
										<h3>Google Map</h3>
										<p>Acc√©der √† Google Map</p>
									</a>
								</li>

							</ul> <!-- .cd-dropdown-icons -->
						</li> <!-- .has-children -->
					</ul> <!-- .cd-dropdown-content -->
				</nav> <!-- .cd-dropdown -->
			</div> <!-- .cd-dropdown-wrapper -->
		</div>

	</header>

	<!--			 MAIN			 -->

	<main class="cd-main-content">
		<section class="hero">
			<div class="hero-text">
				<h1>Cabinet IMSSA</h1>
				<p>Bienvenue sur le site du cabinet IMSSA.<br>
					Vous trouverez ici une biblioth√®que de vid√©os con√ßues
					pour vous accompagner dans vos exercices.
					Chaque patient peut suivre les mouvements expliqu√©s, s‚Äôentra√Æner en toute autonomie et m√™me ajouter ses vid√©os
					pr√©f√©r√©es en favoris afin de les retrouver rapidement.</p>
			</div>
			<img src="img/cabinet.webp" alt="Photo du cabinet" class="hero-img">
		</section>

		<section class="team">
			<h2>Nos praticiens</h2>
			<div class="team-grid">
				<a target="_blank"
					href="https://monrdvkine.fr/masseur-kinesitherapeute/PFASTATT-68120/buob-chloe/rendez-vous">
					<div class="praticien-card">
						<img src="img/praticienne.svg" alt="praticienne">
						<h3>BUOB Chlo√©</h3>
						<p>Kin√© du sport</p>
					</div>
				</a>
				<a target="_blank" href="https://imssa.monrdvkine.fr/p/chaudet-arnaud">
					<div class="praticien-card">
						<img src="img/praticien.svg" alt="praticien">
						<h3>CHAUDET Arnaud</h3>
						<p>Kin√© du sport</p>
					</div>
				</a>
				<a target="_blank" href="https://imssa.monrdvkine.fr/p/laurino-calogero">
					<div class="praticien-card">
						<img src="img/praticien.svg" alt="praticien">
						<h3>LAURINO Calogero</h3>
						<p>Kin√© du sport</p>
					</div>
				</a>
				<a target="_blank" href="https://imssa.monrdvkine.fr/p/nstutz">
					<div class="praticien-card">
						<img src="img/praticien.svg" alt="praticien">
						<h3>STUTZ Nicolas</h3>
						<p>Kin√© du sport</p>
					</div>
				</a>
				<a target="_blank" href="https://imssa.monrdvkine.fr/p/grunenwald-maeva">
					<div class="praticien-card">
						<img src="img/praticienne.svg" alt="praticienne">
						<h3>GRUNENWALD Maeva</h3>
						<p>Kin√© du sport</p>
					</div>
				</a>
			</div>
		</section>
	</main>


	<!--			 MAIN			 -->

	<script src="js/jquery-2.1.1.js"></script>
	<script src="js/jquery.menu-aim.js"></script> <!-- menu aim -->
	<script src="js/main.js"></script> <!-- Resource jQuery -->

	<footer class="site-footer">
		<p>¬© 2025 IMSSA ‚Äì Tous droits r√©serv√©s</p>
		<p>Sports Center Regional Alsace, 5 Rue des Fr√®res Lumi√®re, 68200 Mulhouse</p>
		<a target="_blank" href="https://imssa.monrdvkine.fr/Accueil/ContactCabinet/imssa">Contact</a> | <a
			href="mentions-legales.html">Mentions l√©gales</a>
	</footer>



	<script>
		fetch("videos.json")
			.then(res => res.json())
			.then(data => {
				const menu = document.getElementById("menu");

				for (const grandCategorie in data) {
					const li = document.createElement("li");
					li.classList.add("has-children");

					// Nom de la grande cat√©gorie
					li.innerHTML = `<a href="#0">${grandCategorie}</a>`;

					// Sous-menu
					const ulSecond = document.createElement("ul");
					ulSecond.classList.add("cd-secondary-dropdown", "is-hidden");
					ulSecond.innerHTML = `
        <li class="go-back"><a href="#0">Menu</a></li>
		<li class="see-all">
		<a href="tous-les-exercices.html?categorie=${encodeURIComponent(grandCategorie)}">
			Tous les exercices
		</a>
		</li>
      `;

					const sousCategories = data[grandCategorie];
					for (const sousCat in sousCategories) {
						const liSous = document.createElement("li");
						liSous.classList.add("has-children");
						liSous.innerHTML = `<a href="#0">${sousCat}</a>`;

						const ulVideos = document.createElement("ul");
						ulVideos.classList.add("is-hidden");
						ulVideos.innerHTML = `
          <li class="go-back"><a href="#0">Retour</a></li>
          <li class="see-all">
			  <a href="voir-plus.html?categorie=${encodeURIComponent(grandCategorie)}&souscat=${encodeURIComponent(sousCat)}">
			    Voir tout
			  </a>
			</li>
        `;

						sousCategories[sousCat].forEach(video => {
							const liVideo = document.createElement("li");
							// encodeURIComponent pour √©viter les soucis avec les espaces ou caract√®res sp√©ciaux
							liVideo.innerHTML = `<a href="video.html?url=${encodeURIComponent(video.url)}&titre=${encodeURIComponent(video.titre)}">${video.titre}</a>`;
							ulVideos.appendChild(liVideo);
						});


						liSous.appendChild(ulVideos);
						ulSecond.appendChild(liSous);
					}

					li.appendChild(ulSecond);
					// ‚ö†Ô∏è On ajoute directement au menu, pas dans un <li> vide
					menu.insertAdjacentElement("beforebegin", li);
				}

				// Supprimer le li vide qui sert juste de rep√®re
				menu.remove();

				// Apr√®s avoir inject√© vos nouveaux √©l√©ments dans le DOM
				if (typeof window.reinitializeDropdownEvents === 'function') {
					window.reinitializeDropdownEvents();
				}
			});

	</script>





	<script type="module">
		// 1) Imports Firebase (v12 modules)
		import { initializeApp } from "https://www.gstatic.com/firebasejs/12.0.0/firebase-app.js";
		import {
			getAuth,
			onAuthStateChanged,
			signInWithPopup,
			GoogleAuthProvider,
			signOut
		} from "https://www.gstatic.com/firebasejs/12.0.0/firebase-auth.js";
		import {
			getFirestore,
			doc,
			getDoc,
			setDoc
		} from "https://www.gstatic.com/firebasejs/12.0.0/firebase-firestore.js";

		// 2) Ta config Firebase (copi√©e depuis la console > CDN > Compat ou Modules)
		const firebaseConfig = {
			apiKey: "AIzaSyA7r18GtsCIi1n2AoaBFG-lAYyBPXFIw4Q",
			authDomain: "imssa-2d3cb.firebaseapp.com",
			projectId: "imssa-2d3cb",
			storageBucket: "imssa-2d3cb.appspot.com",
			messagingSenderId: "976927404721",
			appId: "1:976927404721:web:3484dd21e9e52a1e692890",
			measurementId: "G-SKTEPM9LKC"
		};

		// 3) Initialisation Firebase
		const app = initializeApp(firebaseConfig);
		const auth = getAuth(app);
		const db = getFirestore(app);

		// 4) Gestion du bouton Google Sign-In / Sign-Out
		const btnGoogle = document.getElementById("btn-google");
		btnGoogle.addEventListener("click", () => {
			if (!auth.currentUser) {
				signInWithPopup(auth, new GoogleAuthProvider()).catch(console.error);
			} else {
				signOut(auth).catch(console.error);
			}
		});

		// 5) √âcoute de l‚Äô√©tat de connexion et initialisation des boutons ‚ù§Ô∏è/ü©∂
		const largeurEcran = window.innerWidth; // Largeur de l'√©cran visible
		onAuthStateChanged(auth, async user => {
			if (user) {
				if (largeurEcran > 1024) {
					btnGoogle.textContent = `üë§ ${user.displayName}`;
				} else {
					btnGoogle.textContent = `üë§`;
				}
				// R√©cup√®re les favoris dans Firestore
				const ref = doc(db, "users", user.uid);
				const snap = await getDoc(ref);
				const favs = snap.exists() ? snap.data().favoris : [];
				initButtons(favs, user.uid);
			} else {
				if (largeurEcran > 1024) {
					btnGoogle.textContent = "üîí Se connecter";
				} else {
					btnGoogle.textContent = `üîí`;
				}
				initButtons([], null);
			}
		});

		// 6) Fonctions de gestion des favoris
		async function toggleFavori(id, label, btn, uid) {
			if (!uid) {
				alert("Connectez-vous d‚Äôabord pour g√©rer vos favoris.");
				return;
			}
			const ref = doc(db, "users", uid);
			const snap = await getDoc(ref);
			let favs = snap.exists() ? snap.data().favoris : [];
			const idx = favs.findIndex(f => f.id === id);
			if (idx !== -1) favs.splice(idx, 1);
			else favs.push({ id, label });
			// Sauvegarde en base
			await setDoc(ref, { favoris: favs }, { merge: true });
			// Mise √† jour du bouton
			btn.textContent = idx !== -1 ? "ü©∂" : "‚ù§Ô∏è";
		}

		function initButtons(favs, uid) {
			document.querySelectorAll(".fav-btn").forEach(btn => {
				const { id, label } = btn.dataset;
				btn.textContent = favs.some(f => f.id === id) ? "‚ù§Ô∏è" : "ü©∂";
				btn.onclick = () => toggleFavori(id, label, btn, uid);
			});
		}
	</script>
</body>

</html>