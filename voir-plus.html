<!doctype html>
<html lang="fr" class="no-js">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="stylesheet" href="css/reset.css"> <!-- CSS reset -->
    <link rel="stylesheet" href="css/style.css"> <!-- Resource style -->
    <script src="js/modernizr.js"></script> <!-- Modernizr -->

    <!-- FAVICON -->
    <link rel="icon" href="img/logoIMSSA.ico" type="image/x-icon">

    <title>Site IMSSA | Voir plus</title>
</head>

<body>
    <header>
        <div class="navbar">
            <div>
                <a href="index.html" class="nav__logo">
                    <img src="img/logoIMSSA.ico" alt="logo IMSSA" id="logo_header"> IMSSA accueil
                </a>
            </div>
            <div class="cd-dropdown-wrapper">

                <a href="menu.html" id="btn-fav" class="navbar-btn">‚ù§Ô∏è</a>
                <a href="#0" id="btn-google" class="navbar-btn">üîí</a>

                <!--		 DROPDOWN		 -->
                <a class="cd-dropdown-trigger" href="#0">Menu</a>
                <nav class="cd-dropdown">
                    <h2>Menu</h2>
                    <a href="#0" class="cd-close">Fermer</a>
                    <ul class="cd-dropdown-content">

                        <li class="cd-divider">Exercices</li>

                        <!-- Ici on injecte dynamiquement les cat√©gories JSON -->

                        <li id="menu"></li>

                        <li class="cd-divider">Autre</li>

                        <li class="has-children">
                            <a href="http://codyhouse.co/?p=748">Contact</a>
                            <ul class="cd-dropdown-icons is-hidden">
                                <li class="go-back"><a href="#0">Contact</a></li>
                                <li>
                                    <a class="cd-dropdown-item item-1" href="http://codyhouse.co/?p=748">
                                        <h3>Instagram</h3>
                                        <p>This is the item description</p>
                                    </a>
                                </li>

                                <li>
                                    <a class="cd-dropdown-item item-2" href="http://codyhouse.co/?p=748">
                                        <h3>TikTok</h3>
                                        <p>This is the item description</p>
                                    </a>
                                </li>

                                <li>
                                    <a class="cd-dropdown-item item-3" href="http://codyhouse.co/?p=748">
                                        <h3>Mail</h3>
                                        <p>This is the item description</p>
                                    </a>
                                </li>

                                <li>
                                    <a class="cd-dropdown-item item-4" href="http://codyhouse.co/?p=748">
                                        <h3>MonRdvKin√©</h3>
                                        <p>This is the item description</p>
                                    </a>
                                </li>

                                <li>
                                    <a class="cd-dropdown-item item-5" href="http://codyhouse.co/?p=748">
                                        <h3>T√©l√©phone</h3>
                                        <p>This is the item description</p>
                                    </a>
                                </li>

                                <li>
                                    <a class="cd-dropdown-item item-6" href="http://codyhouse.co/?p=748">
                                        <h3>Google Map</h3>
                                        <p>This is the item description</p>
                                    </a>
                                </li>

                            </ul> <!-- .cd-dropdown-icons -->
                        </li> <!-- .has-children -->
                    </ul> <!-- .cd-dropdown-content -->
                </nav> <!-- .cd-dropdown -->
            </div> <!-- .cd-dropdown-wrapper -->
        </div>

    </header>

    <!--			 MAIN			 -->

    <main class="cd-main-content">
        <h1 id="titre"></h1>
        <div id="videos"></div>

    </main>


    <!--			 MAIN			 -->

    <script src="js/jquery-2.1.1.js"></script>
    <script src="js/jquery.menu-aim.js"></script> <!-- menu aim -->
    <script src="js/main.js"></script> <!-- Resource jQuery -->

    <footer class="site-footer">
        <p>&copy; Cabinet Kin√©</p>
    </footer>


    <script>
        // Fonction menu d√©roulant
        fetch("videos.json")
            .then(res => res.json())
            .then(data => {
                const menu = document.getElementById("menu");

                for (const grandCategorie in data) {
                    const li = document.createElement("li");
                    li.classList.add("has-children");

                    // Nom de la grande cat√©gorie
                    li.innerHTML = `<a href="#0">${grandCategorie}</a>`;

                    // Sous-menu
                    const ulSecond = document.createElement("ul");
                    ulSecond.classList.add("cd-secondary-dropdown", "is-hidden");
                    ulSecond.innerHTML = `
        <li class="go-back"><a href="#0">Menu</a></li>
		<li class="see-all">
		<a href="tous-les-exercices.html?categorie=${encodeURIComponent(grandCategorie)}">
			Tous les exercices
		</a>
		</li>
      `;

                    const sousCategories = data[grandCategorie];
                    for (const sousCat in sousCategories) {
                        const liSous = document.createElement("li");
                        liSous.classList.add("has-children");
                        liSous.innerHTML = `<a href="#0">${sousCat}</a>`;

                        const ulVideos = document.createElement("ul");
                        ulVideos.classList.add("is-hidden");
                        ulVideos.innerHTML = `
          <li class="go-back"><a href="#0">Retour</a></li>
          <li class="see-all">
			  <a href="voir-plus.html?categorie=${encodeURIComponent(grandCategorie)}&souscat=${encodeURIComponent(sousCat)}">
			    Voir tout
			  </a>
			</li>
        `;

                        sousCategories[sousCat].forEach(video => {
                            const liVideo = document.createElement("li");
                            liVideo.innerHTML = `<a href="${video.url}" target="_blank">${video.titre}</a>`;
                            ulVideos.appendChild(liVideo);
                        });

                        liSous.appendChild(ulVideos);
                        ulSecond.appendChild(liSous);
                    }

                    li.appendChild(ulSecond);
                    // ‚ö†Ô∏è On ajoute directement au menu, pas dans un <li> vide
                    menu.insertAdjacentElement("beforebegin", li);
                }

                // Supprimer le li vide qui sert juste de rep√®re
                menu.remove();

				// Apr√®s avoir inject√© vos nouveaux √©l√©ments dans le DOM
				if (typeof window.reinitializeDropdownEvents === 'function') {
				    window.reinitializeDropdownEvents();
				}
            });

    </script>


    <script>
        // Fonction pour lire les param√®tres d‚ÄôURL
        function getQueryParam(name) {
            return new URLSearchParams(window.location.search).get(name);
        }

        const grandCategorie = getQueryParam("categorie");
        const sousCategorie = getQueryParam("souscat");

        document.getElementById("titre").textContent = `${grandCategorie} - ${sousCategorie}`;

        fetch("videos.json")
            .then(res => res.json())
            .then(data => {
                const container = document.getElementById("videos");
                const listeVideos = data[grandCategorie]?.[sousCategorie] || [];

                if (listeVideos.length === 0) {
                    container.innerHTML = "<p>Aucune vid√©o trouv√©e.</p>";
                    return;
                }

                listeVideos.forEach(video => {
                    const div = document.createElement("div");
                    div.className = "video";

                    div.innerHTML = `
            <h3>${video.titre}</h3>
            <iframe src="${video.url}" allowfullscreen></iframe>
          `;

                    container.appendChild(div);
                });
            });

        // Fonction utilitaire pour transformer une URL YouTube en ID
        function extraireIdYoutube(url) {
            const regex = /(?:youtube\.com\/.*v=|youtu\.be\/)([^&]+)/;
            const match = url.match(regex);
            return match ? match[1] : "";
        }
    </script>
</body>

</html>

